<script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/esm/supabase.min.js';
    import { Auth } from 'https://cdn.jsdelivr.net/npm/@supabase/auth-ui-js@2/dist/esm/index.js';
    import { ThemeSupa } from 'https://cdn.jsdelivr.net/npm/@supabase/auth-ui-shared@2/dist/esm/index.js';

    const SUPABASE_URL = 'https://tzzrqhyupdlyjkoyltjc.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6enJxaHl1cGRseWprb3lsdGpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MzU4MjUsImV4cCI6MjA3NzQxMTgyNX0.dWca4rRWrUzApTKCRbPFeYnEcRXnU9vALZ3pbDDW1A';
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const { data: { session } } = await supabase.auth.getSession();
    if (session) window.location.href = 'index.html';

    Auth({
        supabaseClient: supabase,
        container: '#auth-container',
        appearance: {
            theme: ThemeSupa,
            variables: {
                default: {
                    colors: {
                        brand: '#2563eb',
                        brandAccent: '#1d4ed8'
                    }
                }
            }
        },
        localization: {
            variables: {
                sign_in: { email_label: 'ईमेल पता', password_label: 'पासवर्ड', button_label: 'साइन इन करें', link_text: 'पहले से सदस्य नहीं हैं? साइन अप करें' },
                sign_up: { email_label: 'ईमेल पता', password_label: 'पासवर्ड', button_label: 'साइन अप करें', link_text: 'पहले से सदस्य हैं? साइन इन करें' },
                forgotten_password: { email_label: 'ईमेल पता', button_label: 'पासवर्ड रीसेट निर्देश भेजें', link_text: 'पासवर्ड भूल गए?' }
            },
        },
        view: 'sign_in'
    });

    supabase.auth.onAuthStateChange((event, session) => {
        if (event === 'SIGNED_IN') {
            window.location.href = 'index.html';
        }
    });
</script>
